{% extends 'base.html.twig' %}

{% block title %}Page d'accueil{% endblock %}

{% block body %}
    <div>
        <div class="col-lg-8 mx-auto p-5 py-md-5">
            <div class="mt-3 text-center">
                <h1 class="h1 mb-2">Page d'accueil</h1>
            </div>

            <a class="btn btn-primary" href="/appel">Page d'appel</a>

        </div>
    </div>
    <div>
        <canvas id="myChart"></canvas>
    </div>
    <button id="downloadButton" class="btn btn-primary">Télécharger l'image JPG du graphique</button>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <script>
        const ctx = document.getElementById('myChart');

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
                datasets: [{
                    label: 'Test graphique',
                    data: [15, 15, 10, 4, 7, 9],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        const downloadButton = document.getElementById('downloadButton');
        downloadButton.addEventListener('click', () => {
        html2canvas(ctx).then(canvas => {
        const dataURL = canvas.toDataURL('image/jpeg');
        {% if app.user %}
        const fileName = 'graph_' + '{{ user.getFirstName }}' + '.jpg'; // Utilisez la variable Twig pour obtenir le prénom
        {% endif %}
        const a = document.createElement('a');
        a.href = dataURL;
        a.download = fileName;
        a.click();
    });
});

    </script>

{% endblock %}
